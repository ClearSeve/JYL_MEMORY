# 反射

```
Assembly asm = Assembly.LoadFile(dllPathName);//加载dll
Type ty = asm.GetType("namespace.classname");//获取dll中的指定类

Type[] tys = asm.GetTypes();//获取dll中的所有类
Type[] tys = asm.GetExportedTypes(); //获取dll中的所有对外暴露的类

if (null == ty) return ;
object obj = Activator.CreateInstance(ty);//使用无参构造创建类对象


MethodInfo[] mi = ty.GetMethods();//获取类中包含的可以访问的方法
MethodInfo me = ty.GetMethod("fun1");//获取单个方法
me.Invoke(obj,new object[]{1,"a"});//调用方法


Assembly obj = Assembly.GetExecutingAssembly();//获取当前程序集
```
