# 内存分配

## sbrk

```
<unistd.h>
void* sbrk(n)
n>0  分配n个字节的空间
n<0   释放n个字节的空间
n==0  返回当前的位置
sbrk底层自动维护一个位置指针，通过位置的移动分配、释放内存
分配时，指针向后移动n个字节，分配结束后返回值为之前的指针的位置
释放时，指针向回移动n个字节，返回值为之前的指针位置（无意义）
sbrk单向连续，先进后出（先分配的后释放），分配方便，释放不方便
```

## brk

```
int  brk（void *）
失败返回-1
释放方便，分配不方便（brk的指针不移动）

exp：
void *p=sbrk(0); 取当前位置
brk（p+4）；    分配4个字节的空间
brk（p+8）；    分配4个字节的空间（上一步已分配过4个）
brk（p+4）；    释放4个字节空间
brk（p）；      释放所有已分配的内存
```

## mmap

```
memory manage

<sys/mman.h>
void *  mmap(0,//首地址，0代表内核指定
             4,//分配4字节（映射1页）
             PROT_READ|PROT_WRITE,//权限
             MAP_PRIVATE|MAP_ANONYMOUS，//共有或私有    匿名（针对物理内存）
             0,//目标处（如fd），可从文件fd处分配内存，fd必须有足够的大小，0代表系统从硬盘分配
             0//偏移量
             )

mmap用来映射内存，可以是硬盘或文件
```

## munmap

munmap(void* ,4)   释放4字节
