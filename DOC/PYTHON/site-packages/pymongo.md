# pymongo

import pymongo

## 打开

```
打开mongodb

myclient = pymongo.MongoClient("mongodb://localhost:27017/")
```

```
获取数据库列表

dblist = myclient.list_database_names()
```

## 选择数据操作集合

选择数据库  
mydb = myclient['jyl']


选择数据库集合  
mycl = mydb["jylcl"]

## 增加

向集合中插入文档  
插入时"_id"可以指定插入数据的id，不指定则自动分配  
insert_many()插入多个数据，输入参数为列表中包含多个集合  

```
mydict = { 'name':'aaa','age':11} 
x = mycl.insert_one(mydict)
id = x.inserted_id
```

## 修改

设置集合中name为aaa的文档中age为100  
myquery = { "name": "aaa" }  
newvalues = { "$set": { "age": "100" } }  
mycl.update_one(myquery, newvalues)  

## 删除

+ 从集合中删除指定文档  
  myquery = { 'name':'aaa' }  
  mycl.delete_one(myquery)  
+ 从集合中删除所有name中首字母j开头的文档  
  myquery = { "name": {"$regex": "^j"} }  
  x = mycl.delete_many(myquery)  
  count = x.deleted_count  
+ 删除集合中所有文档  
  x = mycl.delete_many({})
  count = x.deleted_count

## 查询

取出的每个文档数据为字典类型

+ 查询集合中第一个文档  
  x = mycl.find_one()
+ 查询集合中所有文档  
  for x in mycl.find(): print(x)
+ 查询集合中所有name为aaa的文档

```
myquery = { "name": "aaa" }
for x in mycl.find(myquery):
  print(x)
```

+ 查询集合中所有name为a开头的文档

```
myquery = { "name": { "$regex": "^a"} }
for x in mycl.find(myquery):
  print(x)
```

+ 将查询的结果降序排列，参数2不写或为1则为升序

```
for x in mycl.find().sort("age", -1):
  print(x)
```
